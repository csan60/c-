# 日志功能说明

## 日志文件保存位置
每次启动程序都会在程序所在目录生成一个新的日志文件，命名格式如下：
```
Injector_Log_YYYYMMDD_HHMMSS.txt
```
例如：`Injector_Log_20241117_153045.txt`

## 日志内容
日志中记录了主要操作、成功或失败信息、错误代码等，方便排查问题。

日志文件的开头包含启动时间、日志路径等信息。例如：
```
=== Injector 日志文件 ===
启动时间: 2024-11-17 15:30:45
日志路径: C:\Program Files\Injector\Injector_Log_20241117_153045.txt
```

之后的每行日志格式如下：
```
[HH:MM:SS.mmm] [LEVEL] 消息内容
```
其中：
- `LEVEL` 表示日志级别，例如 INFO、WARN、ERROR、DEBUG
- `消息内容` 是具体的日志内容

示例：
```
[15:30:45.123] [INFO] 程序启动，命令行: "C:\Program Files\Injector\Injector.exe"
[15:30:45.456] [ERROR] CreateWindowW 失败，错误代码: 1407
```

## 如何使用日志排查问题
当程序无法启动、功能无法使用或出现错误提示时，请打开最新的 `Injector_Log_*.txt` 文件。

重点查找以下信息：
- 是否有 ERROR 等级的日志
- 记录错误的函数名称和错误代码（例如 `CreateWindowW 失败，错误代码: 1407`）
- 程序在哪个阶段失败，例如在 `InitInstance`、`WM_CREATE` 或其他操作中

## 常见日志消息说明
- `程序启动，命令行: ...`：程序已启动
- `COM初始化成功/失败`：初始化 COM 组件的状态
- `GDI+初始化成功/失败`：初始化 GDI+ 的状态，失败可能影响界面渲染
- `CreateWindowW 失败`：创建窗口控件失败，错误代码可用于进一步定位
- `状态：启动失败（需要管理员权限）`：目标程序需要管理员权限
- `状态：已启动并完成注入`：目标程序启动并注入成功

## 注意事项
- 日志文件存放在程序所在目录，若权限不足，可能需要以管理员身份运行程序才能生成日志
- 日志文件较多时，可定期清理或压缩备份
